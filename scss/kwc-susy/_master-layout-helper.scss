@import "susy";
@import "config/master-layouts";

$breakpoints: null;

@mixin set-master-layout($layout-name, $breakpoint-name: null) {
    $breakpoints: map-get($master-layouts, $layout-name) !global;
    @if not($breakpoint-name) { $breakpoint-name: nth(nth($breakpoints, 1), 1); }
    @include layout(get-breakpoint-layout($breakpoint-name));
}

@function get-breakpoint-breakpoint($breakpoint-name) {
    @return map-get(map-get($breakpoints, $breakpoint-name), breakpoint);
}
@function get-breakpoint-layout($breakpoint-name) {
    @return map-get(map-get($breakpoints, $breakpoint-name), layout);
}
@function get-breakpoint-property($breakpoint-name, $property-name) {
    @return map-get(map-get($breakpoints, $breakpoint-name), $property-name);
}

@mixin kwf-breakpoint($breakpoint-name, $layout-name: null) {
    $old-breakpoints: $breakpoints;
    @if $layout-name {
        $breakpoints: map-get($master-layouts, $layout-name) !global;
    }
    $noMq: map-get(map-get($breakpoints, $breakpoint-name), no-mediaqueries);
    @if $noMq {
        $noMq: "html.kwfUp-no-mediaqueries";
    } else {
        $noMq: false;
    }
    $breakpoint: get-breakpoint-breakpoint($breakpoint-name);
    @if $breakpoint {
        @include susy-breakpoint($breakpoint, get-breakpoint-layout($breakpoint-name), $noMq) {
            @content;
        }
    } @else {
        @content;
    }
    $breakpoints: $old-breakpoints !global;
}

@mixin kwf-breakpoints($breakpoint-names, $layout-name: null) {
    @each $breakpoint-name in $breakpoint-names {
        @include kwf-breakpoint($breakpoint-name, $layout-name) {
            @content;
        }
    }
}

/*
@mixin master-layout-breakpoints($master-layout, $breakpoint-names) {
  $prev-layout: null;
  @each $layout-name, $layout-config in $breakpoints {
    $breakpoint: map-get($layout-config, breakpoint);
    $layout: map-get($layout-config, layout);
    @if $prev-layout != $layout {
      @if $breakpoint {
        $no-media-class: null;
        @if map-get($layout-config, no-mediaqueries) {
          $no-media-class: "html.kwfUp-no-mediaqueries";
        }
        @include susy-breakpoint($breakpoint, $layout, $no-media-class) {
          @content;
        }
      } @else {
        @content;
      }
    }
    $prev-layout: $layout;
  }
}
*/
